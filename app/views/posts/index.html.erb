<div class="main-content-container">
  <div class="places-list">
    <% current_user.posts.order('created_at DESC').each do |post| %>
      <div id="place_<%= post.id %>" class="place" data-controller="place" data-place-id="<%= post.id %>">
        <div class="posts-list">
          <div id="post_<%= post.id %>" class="post" data-place-target="post" data-post-id="<%= post.id %>">
            <video id="post_<%= post.id %>_video" class="video cld-video-player"></video>
          </div>
        </div>
      </div>
    <% end %>
  </div>
</div>

<% current_user.posts.each do |post| %>
  <script>
    var cloudinary_video_player_<%= post.id %> = cloudinary.videoPlayer("post_<%= post.id %>_video", {
      cloud_name: 'dfmuyxggs',
      fluid: false,
      muted: true,
      showLogo: false,
      controls: false,
      controlBar: {
        playToggle: false,
        volumeMenuButton: false,
        fullscreenToggle: false,
        currentTimeDisplay: false,
        timeDivider: false,
        durationDisplay: false,
        remainingTimeDisplay: false,
        progressControl: true
      },
      hideContextMenu: true,
      autoplay: true,
      loop: true,
      playsinline: true
    });

    cloudinary_video_player_<%= post.id %>.source("<%= post.video_public_id %>", {
      transformation: {
        width: document.querySelector('#place_<%= post.id %>').clientWidth,
        crop: 'fill'
      }
    });
  </script>
<% end %>
